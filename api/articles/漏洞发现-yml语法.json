{"title":"Poc开发-yml语法","uid":"398f1633e25e991ed31599b8f1b3abe2","slug":"漏洞发现-yml语法","date":"2025-05-21T07:46:31.480Z","updated":"2025-05-21T15:59:57.166Z","comments":true,"path":"api/articles/漏洞发现-yml语法.json","cover":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/blog%20%E5%9B%BE%E7%89%87/e6d0930a-5ea5-4a58-9282-8a97feff4efa.jpg","content":"<h1 id=\"Poc开发-yml语法\"><a href=\"#Poc开发-yml语法\" class=\"headerlink\" title=\"Poc开发-yml语法\"></a>Poc开发-yml语法</h1><p>参考文章：<br><a href=\"https://docs.nuclei.sh/template-guide/introduction\">https://docs.nuclei.sh/template-guide/introduction</a><br><a href=\"https://blog.csdn.net/qq_41315957/article/details/126594572\">https://blog.csdn.net/qq_41315957/article/details/126594572</a><br><a href=\"https://blog.csdn.net/qq_41315957/article/details/126594670\">https://blog.csdn.net/qq_41315957/article/details/126594670</a></p>\n<h2 id=\"基本语法\"><a href=\"#基本语法\" class=\"headerlink\" title=\"基本语法\"></a>基本语法</h2><ul>\n<li>大小写敏感</li>\n<li>使用缩进表示层级关系</li>\n<li>缩进不允许使用 tab，只允许空格</li>\n<li>缩进的空格数不重要，只要相同层级的元素左对齐即可</li>\n<li>#表示注释</li>\n<li>: 号后面要加空格</li>\n</ul>\n<h2 id=\"Yaml-Poc模版：\"><a href=\"#Yaml-Poc模版：\" class=\"headerlink\" title=\"Yaml Poc模版：\"></a>Yaml Poc模版：</h2><p>1、编号 id</p>\n<p>2、信息 info</p>\n<p>3、请求 http file tcp等</p>\n<p>4、匹配 matchers Interactsh</p>\n<p>5、提取 extractors</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#漏洞的唯一标识符。如果满足了下面匹配器（matchers）中的规则，显示出的就是id的值。</span></span><br><span class=\"line\"><span class=\"attr\">id:</span> <span class=\"string\">CVE-2023-28432</span></span><br><span class=\"line\"><span class=\"comment\">#info为描述信息，不是硬规定一定要有哪些。自己看着办要写哪些</span></span><br><span class=\"line\"><span class=\"attr\">info:</span></span><br><span class=\"line\"><span class=\"comment\">#漏洞的名称</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">CVE-2023-28432</span></span><br><span class=\"line\"><span class=\"comment\">#漏洞的作者或发现者</span></span><br><span class=\"line\">  <span class=\"attr\">author:</span> <span class=\"string\">burp</span> <span class=\"string\">suite</span></span><br><span class=\"line\"><span class=\"comment\">#漏洞的严重程度</span></span><br><span class=\"line\">  <span class=\"attr\">severity:</span> <span class=\"string\">severity</span></span><br><span class=\"line\"><span class=\"comment\">#漏洞的详细描述。</span></span><br><span class=\"line\">  <span class=\"attr\">description:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">    MinIO 是在 GNU Affero 通用公共许可证 v3.0 下发布的高性能对象存储。</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"comment\">#漏洞的参考资料，可以是链接地址。</span></span><br><span class=\"line\">  <span class=\"attr\">reference:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">https://github.com/vulhub/vulhub/tree/master/minio/CVE-2023-28432</span></span><br><span class=\"line\"><span class=\"comment\">#漏洞的标签，用于分类和关联其他相关漏洞。也方便到时候整理归类到库里面去</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span> <span class=\"string\">cve,2023</span></span><br><span class=\"line\"><span class=\"comment\">#描述了与该漏洞相关的HTTP请求匹配规则的列表。</span></span><br><span class=\"line\"><span class=\"attr\">http:</span></span><br><span class=\"line\"><span class=\"comment\"># &quot;raw&quot;字段通常指的是原始的HTTP请求字符串。</span></span><br><span class=\"line\"><span class=\"comment\">#使用表单数据时，可以使用form字段。如果你的请求数据是JSON格式的，可以使用json字段。</span></span><br><span class=\"line\"><span class=\"comment\">#对于 URL 编码的数据，可以使用 urlencoded 字段。如果需要模拟文件上传，可以使用 multipart 字段</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"attr\">raw:</span></span><br><span class=\"line\"><span class=\"comment\">#这里面要参考漏洞的触发信息是怎么样的，漏洞需要提交什么样的数据包就怎么编写这里面的内容</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">        POST /minio/bootstrap/v1/verify HTTP/1.1</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"comment\">#&#123;&#123;Hostname&#125;&#125;是一个变量，不要写死。在你使用nuclei程序使用-target参数指定URL的时候会被填充到这里来</span></span><br><span class=\"line\">        <span class=\"attr\">Host:</span> &#123;&#123;<span class=\"string\">Hostname</span>&#125;&#125;</span><br><span class=\"line\">        <span class=\"attr\">Accept-Encoding:</span> <span class=\"string\">gzip,</span> <span class=\"string\">deflate</span></span><br><span class=\"line\">        <span class=\"attr\">Accept:</span> <span class=\"string\">*/*</span></span><br><span class=\"line\">        <span class=\"attr\">Accept-Language:</span> <span class=\"string\">en-US;q=0.9,en;q=0.8</span></span><br><span class=\"line\">        <span class=\"attr\">User-Agent:</span> <span class=\"string\">Mozilla/5.0</span> <span class=\"string\">(Windows</span> <span class=\"string\">NT</span> <span class=\"number\">10.0</span><span class=\"string\">;</span> <span class=\"string\">Win64;</span> <span class=\"string\">x64)</span> <span class=\"string\">AppleWebKit/537.36</span> <span class=\"string\">(KHTML,</span> <span class=\"string\">like</span> <span class=\"string\">Gecko)</span> <span class=\"string\">Chrome/110.0.5481.178</span> <span class=\"string\">Safari/537.36</span></span><br><span class=\"line\">        <span class=\"attr\">Connection:</span> <span class=\"string\">close</span></span><br><span class=\"line\">        <span class=\"attr\">Cache-Control:</span> <span class=\"string\">max-age=0</span></span><br><span class=\"line\">        <span class=\"attr\">Content-Type:</span> <span class=\"string\">application/x-www-form-urlencoded</span></span><br><span class=\"line\">        <span class=\"attr\">Content-Length:</span> <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#定义了匹配器的条件，表示所有的匹配器都必须满足。</span></span><br><span class=\"line\">    <span class=\"attr\">matchers-condition:</span> <span class=\"string\">and</span></span><br><span class=\"line\">    <span class=\"comment\">#匹配器 漏洞条件的特征点写在里面</span></span><br><span class=\"line\">    <span class=\"attr\">matchers:</span></span><br><span class=\"line\"><span class=\"comment\">#匹配器的类型，用于在响应的特定位置寻找指定的关键字。</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">type:</span> <span class=\"string\">word</span></span><br><span class=\"line\"><span class=\"comment\"># 指定要匹配的部分是响应的body部分。</span></span><br><span class=\"line\">        <span class=\"attr\">part:</span> <span class=\"string\">body</span></span><br><span class=\"line\"><span class=\"comment\">#指定要匹配的关键字列表，如果在响应主体中找到了这些关键字，将认为漏洞存在。</span></span><br><span class=\"line\">        <span class=\"attr\">words:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"string\">&#x27;MINIO_ROOT_USER&#x27;</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"string\">&#x27;MINIO_ROOT_PASSWORD&#x27;</span></span><br><span class=\"line\">      <span class=\"comment\">#另一个匹配器类型，用于匹配响应的状态码。</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">type:</span> <span class=\"string\">status</span></span><br><span class=\"line\"><span class=\"comment\">#指定要匹配的状态码列表，如果响应的状态码为200（成功），将认为漏洞存在。</span></span><br><span class=\"line\">        <span class=\"attr\">status:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"number\">200</span></span><br></pre></td></tr></table></figure>\n\n<p>使用方式：nuclei.exe -t Your_YamlFile -target 目标地址</p>\n","text":"Poc开发-yml语法参考文章：https://docs.nuclei.sh/template-guide/introductionhttps://blog.c...","permalink":"/post/漏洞发现-yml语法","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[{"name":"漏洞发现","slug":"漏洞发现","count":1,"path":"api/categories/漏洞发现.json"}],"tags":[{"name":"漏洞发现","slug":"漏洞发现","count":1,"path":"api/tags/漏洞发现.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Poc%E5%BC%80%E5%8F%91-yml%E8%AF%AD%E6%B3%95\"><span class=\"toc-text\">Poc开发-yml语法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95\"><span class=\"toc-text\">基本语法</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Yaml-Poc%E6%A8%A1%E7%89%88%EF%BC%9A\"><span class=\"toc-text\">Yaml Poc模版：</span></a></li></ol></li></ol>","author":{"name":"Hao","slug":"blog-author","avatar":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/ppp/64966b30e1c9375e8dbb11146ea9c12f.jpg","link":"/","description":"山高自有客行路，水深自有渡船认 The future is like the sea and three will be a long time to come","socials":{"github":"https://github.com/isMyHao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/2401_87971103?spm=1000.2115.3001.10640","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"PHP-代码审计-1","uid":"acb54170ac17da99f77fb481ec7f7fa5","slug":"PHP代码审计","date":"2025-05-22T09:23:12.983Z","updated":"2025-05-22T10:03:14.425Z","comments":true,"path":"api/articles/PHP代码审计.json","cover":null,"text":"PHP-代码审计-1关于SQL的审计：挖掘技巧： 语句监控-数据库SQL监控排查可利用语句定向分析 功能追踪-功能点文件SQL执行代码函数调用链追踪 正则搜索-...","permalink":"/post/PHP代码审计","photos":[],"count_time":{"symbolsCount":177,"symbolsTime":"1 mins."},"categories":[{"name":"PHP代码审计","slug":"PHP代码审计","count":1,"path":"api/categories/PHP代码审计.json"}],"tags":[{"name":"PHP代码审计","slug":"PHP代码审计","count":1,"path":"api/tags/PHP代码审计.json"}],"author":{"name":"Hao","slug":"blog-author","avatar":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/ppp/64966b30e1c9375e8dbb11146ea9c12f.jpg","link":"/","description":"山高自有客行路，水深自有渡船认 The future is like the sea and three will be a long time to come","socials":{"github":"https://github.com/isMyHao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/2401_87971103?spm=1000.2115.3001.10640","juejin":"","customs":{}}}},"next_post":{"title":"kubernetes-goat靶场","uid":"018a2a8f1c82adfd1221467a2a861fc0","slug":"kubernetes-goat靶场","date":"2025-05-20T12:33:38.723Z","updated":"2025-05-22T16:48:57.060Z","comments":true,"path":"api/articles/kubernetes-goat靶场.json","cover":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/blog%20%E5%9B%BE%E7%89%87/c160b854-1f3c-4901-9990-093288ad1c04.jpg","text":"kubernetes-goat靶场Kubernetes Goat 被设计成一个故意设置易受攻击的集群环境，用于学习和实践 Kubernetes 安全性 安装： ...","permalink":"/post/kubernetes-goat靶场","photos":[],"count_time":{"symbolsCount":"9k","symbolsTime":"8 mins."},"categories":[{"name":"靶场","slug":"靶场","count":1,"path":"api/categories/靶场.json"}],"tags":[{"name":"靶场","slug":"靶场","count":1,"path":"api/tags/靶场.json"}],"author":{"name":"Hao","slug":"blog-author","avatar":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/ppp/64966b30e1c9375e8dbb11146ea9c12f.jpg","link":"/","description":"山高自有客行路，水深自有渡船认 The future is like the sea and three will be a long time to come","socials":{"github":"https://github.com/isMyHao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/2401_87971103?spm=1000.2115.3001.10640","juejin":"","customs":{}}}}}